---
title: "M4A_Project"
author: "Ross Pingatore"
date: "10/30/2020"
output: pdf_document
---

```{r, message=FALSE, warning=FALSE}
library(readxl)
medicare_for_all_1 <- read_excel("Data/medicare_for_all_1.xlsx")
single_payer_system_1 <- read_excel("Data/single_payer_system_1.xlsx")
universal_health_care_1 <- read_excel("Data/universal_health_care_1.xlsx")
medicare_for_all_2 <- read_excel("Data/medicare_for_all_2.xlsx")
single_payer_system_2 <- read_excel("Data/single_payer_system_2.xlsx")
universal_health_care_2 <- read_excel("Data/universal_health_care_2.xlsx")

data_names <- c(medicare_for_all_1,single_payer_system_1,universal_health_care_1,medicare_for_all_2,single_payer_system_2,universal_health_care_2)
```


```{r}
suppressPackageStartupMessages(library(tidyverse))
merged_data <- bind_rows(medicare_for_all_1,single_payer_system_1,universal_health_care_1,medicare_for_all_2,single_payer_system_2,universal_health_care_2)

write_excel_csv(merged_data, 'Data/merged_data.xlsx')
view(merged_data)
```

```{r}
unique(merged_data$Language)
```

```{r, working with the text, fig.width=12, fig.height=4.5}
library(tidytext)
library(tm)
library(dplyr)
library(NLP)
#https://stackoverflow.com/questions/36824296/r-remove-specific-word-in-a-txte-like-the-this

corpus <- Corpus(VectorSource(merged_data$Text))


corpus <- tm_map(corpus, removePunctuation)
corpus <- tm_map(corpus, removeNumbers)
corpus <- tm_map(corpus, tolower)
corpus <- tm_map(corpus, removeWords, stopwords("english")) 
corpus <- tm_map(corpus, stripWhitespace)
corpus <- tm_map(corpus, stemDocument)

doc_matrix <- TermDocumentMatrix(corpus)
doc_matrix_m <- as.matrix(doc_matrix)
doc_matrix_val <- sort(rowSums(doc_matrix_m), decreasing = T)
doc_matrix_df <- data.frame(word = names(doc_matrix_val), freq = doc_matrix_val)

top_20 <- head(doc_matrix_df, 20)

top_20%>%
  ggplot(aes(reorder(word,freq), freq)) + geom_bar(stat = "identity") + xlab("Term") + ylab("Frequency") + labs(title = "Most Frequent Terms Within Tweets Relating to Medicare For All")

```
